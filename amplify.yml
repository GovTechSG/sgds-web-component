version: 1
frontend:
  phases:
    preBuild:
      commands:
        - rm -rf node_modules && npm ci
    build:
      commands:
        - STORIES_TO_BUILD=${STORIES_TO_BUILD}
        - npm run test && npm run test:scripts && npm run build-storybook
        - echo "TWITCH_CLIENT_ID=$TWITCH_CLIENT_ID" >> .env
  artifacts:
    baseDirectory: /storybook-static
    files:
      - '**/*'
# test:
#   phases:
#     test:
#       commands:
#         - npm run test
#   artifacts:
#     baseDirectory: coverage
#     configFilePath: '**/coverage-final.json'
#     files: '**/*'