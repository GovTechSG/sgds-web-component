# Next.js Integration

SGDS web components are fully supported in Next.js with React 19+.

## Prerequisites

Before integrating SGDS with Next.js, please read the [React integration guide](/docs/frameworks-react--docs) for foundational concepts.

**Important:** Web components work best as client components as they rely on browser APIs (`document` and `window`).

## Setup

### Step 1: Create Library Loader

Create a file `sgds.tsx` to handle client-side web component initialization:

```tsx
'use client';

import { useEffect } from 'react';

const SgdsLibraryLoader = () => {
  useEffect(() => {
    (async () => {
      try {
        const sgdsLibrary = await import('@govtechsg/sgds-web-component');
        console.log('SGDS library loaded:', sgdsLibrary);
      } catch (error) {
        console.error('Failed to load SGDS library:', error);
      }
    })();
  }, []);

  return null;
};

export default SgdsLibraryLoader;
```

### Step 2: Import in Root Layout

Add the library loader to your root layout (`src/app/layout.tsx`):

```tsx
import SgdsLibraryLoader from "./sgds";
import { Inter } from "next/font/google";
import type { Metadata } from "next";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app"
};

export default function RootLayout({
  children
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <head>
        <SgdsLibraryLoader />
      </head>
      <body className={inter.className}>
        {children}
      </body>
    </html>
  );
}
```

### Step 3: Import CSS Files

Import SGDS CSS files in your global styles or root layout:

```tsx
// In your root layout or global CSS file
import '@govtechsg/sgds-web-component/themes/day.css';
import '@govtechsg/sgds-web-component/themes/night.css';
import '@govtechsg/sgds-web-component/css/sgds.css';
```

## Common Issues and Solutions

### 1. Event Listeners Not Firing on First Load

**Problem:** Custom event listeners fail to attach due to Next.js hydration timing.

**Solution:** Add event listeners in a `useEffect` hook instead of declaratively:

```tsx
'use client';

import { type JSX, useEffect, useRef } from 'react';

interface Props {
  className?: string;
  label?: string;
  placeholder?: string;
  value?: string;
  onInput?: (value: string) => void;
}

const SgdsInput = ({
  className,
  label,
  placeholder,
  value,
  onInput = () => {}
}: Props): JSX.Element => {
  const inputRef = useRef<any>(null);

  useEffect(() => {
    const input = inputRef.current;
    if (!input) return;

    const handleInput = (event: CustomEvent<{ value: string }>) => {
      const inputElement = event.target as HTMLInputElement;
      onInput(inputElement.value);
    };

    input.addEventListener('sgds-input', handleInput);
    
    return () => {
      input.removeEventListener('sgds-input', handleInput);
    };
  }, [onInput]);

  return (
    <sgds-input
      ref={inputRef}
      className={className}
      label={label}
      placeholder={placeholder}
      value={value}
      suppressHydrationWarning
    >
      <sgds-icon slot="icon" name="search" suppressHydrationWarning />
    </sgds-input>
  );
};

export default SgdsInput;
```

### 2. Hydration Mismatch Warnings

**Problem:** Next.js detects attribute differences between server and client rendering.

**Cause:** Web components add attributes during browser parsing that weren't declared in the initial markup.

**Solution:** Add `suppressHydrationWarning` to web component elements:

```tsx
<sgds-input suppressHydrationWarning>
  <sgds-icon slot="icon" name="search" suppressHydrationWarning />
</sgds-input>
```

### 3. TypeScript Support

Add type definitions for SGDS web components in a `types.d.ts` file:

```typescript
import * as React from 'react';

declare global {
  namespace JSX {
    interface IntrinsicElements {
      'sgds-masthead': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
      'sgds-input': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
      'sgds-button': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
      'sgds-icon': React.DetailedHTMLProps<React.HTMLAttributes<HTMLElement>, HTMLElement>;
      // Add other SGDS components as needed
    }
  }
}
```

### 4. Flash of unstyled content 

Read more about [FOUC](/docs/troubleshoot-flash-of-unstyled-content--docs)